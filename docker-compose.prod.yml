version: '3.8'

# Production overrides for docker-compose.yml
# Usage: docker-compose -f docker-compose.yml -f docker-compose.prod.yml up

services:
  backend:
    environment:
      - ENVIRONMENT=production
      - DEBUG=false
    volumes: []  # Remove development volumes
    restart: always

  frontend:
    build:
      target: production  # Use production build stage
      args:
        # Set production API URL - override with environment variable if needed
        VITE_API_BASE_URL: ${VITE_API_BASE_URL:-http://backend:8000}
    ports:
      - "80:80"  # Serve on port 80 in production
    volumes: []  # Remove development volumes
    environment: []  # Remove development environment variables
    restart: always

  redis:
    restart: always
    # Production Redis configuration
    command: redis-server --appendonly yes --maxmemory 256mb --maxmemory-policy allkeys-lru
